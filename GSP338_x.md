# Monitor and Log with Google Cloud Observability: Challenge Lab

---

## Task 1. Configure Cloud Monitoring

#### Your first task is to enable Cloud Monitoring for your project.

#### A basic Cloud Monitoring dashboard, called Media_Dashboard, will be made available to you automatically, but you have to enable Cloud Monitoring in your project before you will be able to access this dashboard.

---

## Task 2. Configure a Compute Instance to generate Custom Cloud Monitoring metrics

#### 1. Your next task is to confirm that the monitoring service that checks the length of the video processing queue is working correctly.

#### 2. You must modify the startup script for the video-queue-monitor Compute Instance so that the queue monitoring application (the Go application) can create and write to custom metrics. Once you have updated the startup script you will need to restart the instance.

goto vm
stop video-queue-monitor instance
click video-queue-monitor
click edit button
go to metadata, fill project_id and instance_id in environment script
save
restart the instance

#### 3. You can confirm that the application is working by searching for the metric input_queue_size in the Metrics Explorer in Cloud Monitoring.

---

## Task 3. Create a custom metric using Cloud Operations logging events

#### 1. Examine the Cloud Operations logs and create a custom metric that tracks the total volume of uploaded media files to your Cloud Function. The video upload Cloud Function creates a Cloud Operations Logging event that includes metadata about the type of video file the video processing system handles.

#### 2. You have been asked to configure a custom log based metric called <custom_metric_name> that will monitor the rate at which high resolution video files, those recorded at either 4K or 8K resolution, are uploaded.

go to logs explorer
fill query with tip 4 in tips and trick
run query
click action and create metrics
Name log-based metric name with <custom_metric_name>
leave all default and clik create metric

---

## Task 4. Add custom metrics to the Media Dashboard in Cloud Operations Monitoring

#### You must now add two charts to the Media Dashboard:

go to dashboard
click Media_Dashboard

#### 1. Add a chart for the video input queue length custom metric that is generated by the Go application running on the video-queue-monitor Compute Instance.

add widget
choose line
at metric, type "custom metric"
choose vm instance > Custom Metric > OpenCensus
click apply

add filters
choose instance_id with value of instance_id of video-queue-monitor instance
click apply

#### 2. Add a chart for the high resolution video upload rate custom log based metric to the Media_Dashboard custom dashboard.

add widget
choose line
at metric, type logging
click active button
choose vm instance > log-based metrics > big_video_upload_rate
click apply

---

## Task 5. Create a Cloud Operations alert based on the rate of high resolution video file uploads

#### Create a custom alert using the high resolution video upload metric that triggers when the upload rate for large videos exceeds a count of <Alert_Threshold> per second.

click allerting
click "+ create policy"
at metric, type logging
click active button
choose vm instance > log-based metrics > big_video_upload_rate
click apply
leave the rest default, click next

at treshold value, enter <Alert_Threshold>
click next

deselect Use notification channel
name the "alert policy name"
click create
